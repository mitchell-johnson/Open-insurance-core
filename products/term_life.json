{
  "$schema": "https://gorules.io/schemas/jdm/1.0.0",
  "contentType": "application/vnd.gorules.decision",
  "name": "Term Life Insurance Product Rules",
  "description": "Underwriting and rating rules for term life insurance products",
  "nodes": [
    {
      "id": "input",
      "name": "Request",
      "type": "inputNode",
      "position": { "x": 100, "y": 200 }
    },
    {
      "id": "output",
      "name": "Response",
      "type": "outputNode",
      "position": { "x": 900, "y": 200 }
    },
    {
      "id": "eligibility_check",
      "name": "Eligibility Check",
      "type": "decisionTableNode",
      "position": { "x": 300, "y": 100 },
      "content": {
        "hitPolicy": "first",
        "inputs": [
          { "id": "age", "name": "Age", "field": "applicant.age" },
          { "id": "sum_assured", "name": "Sum Assured", "field": "coverage.sum_assured" },
          { "id": "term", "name": "Term Years", "field": "coverage.term_years" }
        ],
        "outputs": [
          { "id": "eligible", "name": "Eligible", "field": "eligible" },
          { "id": "reason", "name": "Reason", "field": "eligibility_reason" }
        ],
        "rules": [
          {
            "inputs": [{ "id": "age", "value": "< 18" }, { "id": "sum_assured", "value": "-" }, { "id": "term", "value": "-" }],
            "outputs": [{ "id": "eligible", "value": "false" }, { "id": "reason", "value": "\"Minimum age is 18\"" }]
          },
          {
            "inputs": [{ "id": "age", "value": "> 70" }, { "id": "sum_assured", "value": "-" }, { "id": "term", "value": "-" }],
            "outputs": [{ "id": "eligible", "value": "false" }, { "id": "reason", "value": "\"Maximum entry age is 70\"" }]
          },
          {
            "inputs": [{ "id": "age", "value": "-" }, { "id": "sum_assured", "value": "> 5000000" }, { "id": "term", "value": "-" }],
            "outputs": [{ "id": "eligible", "value": "false" }, { "id": "reason", "value": "\"Maximum sum assured is 5,000,000\"" }]
          },
          {
            "inputs": [{ "id": "age", "value": "-" }, { "id": "sum_assured", "value": "< 50000" }, { "id": "term", "value": "-" }],
            "outputs": [{ "id": "eligible", "value": "false" }, { "id": "reason", "value": "\"Minimum sum assured is 50,000\"" }]
          },
          {
            "inputs": [{ "id": "age", "value": "-" }, { "id": "sum_assured", "value": "-" }, { "id": "term", "value": "< 5" }],
            "outputs": [{ "id": "eligible", "value": "false" }, { "id": "reason", "value": "\"Minimum term is 5 years\"" }]
          },
          {
            "inputs": [{ "id": "age", "value": "-" }, { "id": "sum_assured", "value": "-" }, { "id": "term", "value": "> 30" }],
            "outputs": [{ "id": "eligible", "value": "false" }, { "id": "reason", "value": "\"Maximum term is 30 years\"" }]
          },
          {
            "inputs": [{ "id": "age", "value": "-" }, { "id": "sum_assured", "value": "-" }, { "id": "term", "value": "-" }],
            "outputs": [{ "id": "eligible", "value": "true" }, { "id": "reason", "value": "\"Eligible for coverage\"" }]
          }
        ]
      }
    },
    {
      "id": "smoker_loading",
      "name": "Smoker Loading",
      "type": "decisionTableNode",
      "position": { "x": 300, "y": 250 },
      "content": {
        "hitPolicy": "first",
        "inputs": [
          { "id": "smoker", "name": "Is Smoker", "field": "medical.is_smoker" },
          { "id": "former", "name": "Former Smoker", "field": "medical.is_former_smoker" },
          { "id": "quit_years", "name": "Years Since Quit", "field": "medical.years_since_quit" }
        ],
        "outputs": [
          { "id": "loading", "name": "Loading %", "field": "smoker_loading_percent" },
          { "id": "class", "name": "Smoker Class", "field": "smoker_class" }
        ],
        "rules": [
          {
            "inputs": [{ "id": "smoker", "value": "true" }, { "id": "former", "value": "-" }, { "id": "quit_years", "value": "-" }],
            "outputs": [{ "id": "loading", "value": "100" }, { "id": "class", "value": "\"smoker\"" }]
          },
          {
            "inputs": [{ "id": "smoker", "value": "false" }, { "id": "former", "value": "true" }, { "id": "quit_years", "value": "< 1" }],
            "outputs": [{ "id": "loading", "value": "75" }, { "id": "class", "value": "\"recent_quit\"" }]
          },
          {
            "inputs": [{ "id": "smoker", "value": "false" }, { "id": "former", "value": "true" }, { "id": "quit_years", "value": "[1..3)" }],
            "outputs": [{ "id": "loading", "value": "50" }, { "id": "class", "value": "\"former_smoker\"" }]
          },
          {
            "inputs": [{ "id": "smoker", "value": "false" }, { "id": "former", "value": "true" }, { "id": "quit_years", "value": "[3..5)" }],
            "outputs": [{ "id": "loading", "value": "25" }, { "id": "class", "value": "\"former_smoker\"" }]
          },
          {
            "inputs": [{ "id": "smoker", "value": "false" }, { "id": "former", "value": "-" }, { "id": "quit_years", "value": "-" }],
            "outputs": [{ "id": "loading", "value": "0" }, { "id": "class", "value": "\"non_smoker\"" }]
          }
        ]
      }
    },
    {
      "id": "bmi_loading",
      "name": "BMI Loading",
      "type": "decisionTableNode",
      "position": { "x": 300, "y": 400 },
      "content": {
        "hitPolicy": "first",
        "inputs": [
          { "id": "bmi", "name": "BMI", "field": "medical.bmi" }
        ],
        "outputs": [
          { "id": "loading", "name": "Loading %", "field": "bmi_loading_percent" },
          { "id": "action", "name": "Action", "field": "bmi_action" }
        ],
        "rules": [
          {
            "inputs": [{ "id": "bmi", "value": "< 16" }],
            "outputs": [{ "id": "loading", "value": "0" }, { "id": "action", "value": "\"decline\"" }]
          },
          {
            "inputs": [{ "id": "bmi", "value": "[16..17)" }],
            "outputs": [{ "id": "loading", "value": "75" }, { "id": "action", "value": "\"refer\"" }]
          },
          {
            "inputs": [{ "id": "bmi", "value": "[17..18.5)" }],
            "outputs": [{ "id": "loading", "value": "25" }, { "id": "action", "value": "\"accept\"" }]
          },
          {
            "inputs": [{ "id": "bmi", "value": "[18.5..25)" }],
            "outputs": [{ "id": "loading", "value": "0" }, { "id": "action", "value": "\"accept\"" }]
          },
          {
            "inputs": [{ "id": "bmi", "value": "[25..30)" }],
            "outputs": [{ "id": "loading", "value": "15" }, { "id": "action", "value": "\"accept\"" }]
          },
          {
            "inputs": [{ "id": "bmi", "value": "[30..35)" }],
            "outputs": [{ "id": "loading", "value": "35" }, { "id": "action", "value": "\"accept\"" }]
          },
          {
            "inputs": [{ "id": "bmi", "value": "[35..40)" }],
            "outputs": [{ "id": "loading", "value": "75" }, { "id": "action", "value": "\"refer\"" }]
          },
          {
            "inputs": [{ "id": "bmi", "value": ">= 40" }],
            "outputs": [{ "id": "loading", "value": "0" }, { "id": "action", "value": "\"decline\"" }]
          }
        ]
      }
    },
    {
      "id": "age_band_rates",
      "name": "Age Band Base Rates",
      "type": "decisionTableNode",
      "position": { "x": 500, "y": 100 },
      "content": {
        "hitPolicy": "first",
        "inputs": [
          { "id": "age", "name": "Age", "field": "applicant.age" },
          { "id": "gender", "name": "Gender", "field": "applicant.gender" }
        ],
        "outputs": [
          { "id": "rate", "name": "Base Rate per 1000", "field": "base_rate_per_thousand" }
        ],
        "rules": [
          { "inputs": [{ "id": "age", "value": "[18..25)" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "0.45" }] },
          { "inputs": [{ "id": "age", "value": "[18..25)" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "0.35" }] },
          { "inputs": [{ "id": "age", "value": "[25..30)" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "0.55" }] },
          { "inputs": [{ "id": "age", "value": "[25..30)" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "0.42" }] },
          { "inputs": [{ "id": "age", "value": "[30..35)" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "0.72" }] },
          { "inputs": [{ "id": "age", "value": "[30..35)" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "0.55" }] },
          { "inputs": [{ "id": "age", "value": "[35..40)" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "0.95" }] },
          { "inputs": [{ "id": "age", "value": "[35..40)" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "0.72" }] },
          { "inputs": [{ "id": "age", "value": "[40..45)" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "1.45" }] },
          { "inputs": [{ "id": "age", "value": "[40..45)" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "1.10" }] },
          { "inputs": [{ "id": "age", "value": "[45..50)" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "2.25" }] },
          { "inputs": [{ "id": "age", "value": "[45..50)" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "1.65" }] },
          { "inputs": [{ "id": "age", "value": "[50..55)" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "3.55" }] },
          { "inputs": [{ "id": "age", "value": "[50..55)" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "2.45" }] },
          { "inputs": [{ "id": "age", "value": "[55..60)" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "5.65" }] },
          { "inputs": [{ "id": "age", "value": "[55..60)" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "3.85" }] },
          { "inputs": [{ "id": "age", "value": "[60..65)" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "9.25" }] },
          { "inputs": [{ "id": "age", "value": "[60..65)" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "5.95" }] },
          { "inputs": [{ "id": "age", "value": "[65..70]" }, { "id": "gender", "value": "\"male\"" }], "outputs": [{ "id": "rate", "value": "15.50" }] },
          { "inputs": [{ "id": "age", "value": "[65..70]" }, { "id": "gender", "value": "\"female\"" }], "outputs": [{ "id": "rate", "value": "9.75" }] },
          { "inputs": [{ "id": "age", "value": "-" }, { "id": "gender", "value": "-" }], "outputs": [{ "id": "rate", "value": "2.50" }] }
        ]
      }
    },
    {
      "id": "calculate_premium",
      "name": "Calculate Premium",
      "type": "expressionNode",
      "position": { "x": 700, "y": 200 },
      "content": {
        "expressions": [
          {
            "key": "total_loading_percent",
            "value": "smoker_loading_percent + bmi_loading_percent + occupation_loading_percent"
          },
          {
            "key": "loading_multiplier",
            "value": "1 + (total_loading_percent / 100)"
          },
          {
            "key": "annual_premium",
            "value": "(coverage.sum_assured / 1000) * base_rate_per_thousand * loading_multiplier"
          },
          {
            "key": "monthly_premium",
            "value": "annual_premium / 12"
          }
        ]
      }
    },
    {
      "id": "occupation_loading",
      "name": "Occupation Loading",
      "type": "decisionTableNode",
      "position": { "x": 500, "y": 400 },
      "content": {
        "hitPolicy": "first",
        "inputs": [
          { "id": "class", "name": "Occupation Class", "field": "applicant.occupation_class" }
        ],
        "outputs": [
          { "id": "loading", "name": "Loading %", "field": "occupation_loading_percent" }
        ],
        "rules": [
          { "inputs": [{ "id": "class", "value": "1" }], "outputs": [{ "id": "loading", "value": "0" }] },
          { "inputs": [{ "id": "class", "value": "2" }], "outputs": [{ "id": "loading", "value": "15" }] },
          { "inputs": [{ "id": "class", "value": "3" }], "outputs": [{ "id": "loading", "value": "35" }] },
          { "inputs": [{ "id": "class", "value": "4" }], "outputs": [{ "id": "loading", "value": "75" }] },
          { "inputs": [{ "id": "class", "value": "-" }], "outputs": [{ "id": "loading", "value": "25" }] }
        ]
      }
    }
  ],
  "edges": [
    { "id": "e1", "sourceId": "input", "targetId": "eligibility_check" },
    { "id": "e2", "sourceId": "input", "targetId": "smoker_loading" },
    { "id": "e3", "sourceId": "input", "targetId": "bmi_loading" },
    { "id": "e4", "sourceId": "input", "targetId": "age_band_rates" },
    { "id": "e5", "sourceId": "input", "targetId": "occupation_loading" },
    { "id": "e6", "sourceId": "eligibility_check", "targetId": "calculate_premium" },
    { "id": "e7", "sourceId": "smoker_loading", "targetId": "calculate_premium" },
    { "id": "e8", "sourceId": "bmi_loading", "targetId": "calculate_premium" },
    { "id": "e9", "sourceId": "age_band_rates", "targetId": "calculate_premium" },
    { "id": "e10", "sourceId": "occupation_loading", "targetId": "calculate_premium" },
    { "id": "e11", "sourceId": "calculate_premium", "targetId": "output" }
  ],
  "metadata": {
    "product_code": "TERM_LIFE_01",
    "product_name": "Term Life Insurance",
    "version": "1.0.0",
    "effective_date": "2024-01-01",
    "currency": "USD",
    "min_entry_age": 18,
    "max_entry_age": 70,
    "min_term_years": 5,
    "max_term_years": 30,
    "min_sum_assured": 50000,
    "max_sum_assured": 5000000,
    "coverages": ["death_benefit"],
    "optional_riders": ["accidental_death", "waiver_of_premium", "critical_illness"]
  }
}
